<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>FLAME: sim_types, Element types, and Parameter names</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FLAME
   &#160;<span id="projectnumber">devel</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">FLAME documentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">sim_types, Element types, and Parameter names </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="simtypelist"></a>
sim_types</h1>
<p>At present three "sim_type"s are defined: Vector, TransferMatrix, and MomentMatrix.</p>
<h2><a class="anchor" id="simvector"></a>
sim_type=Vector</h2>
<p>Selects use of <a class="el" href="struct_vector_state.html" title="Simulation state which include only a vector. ">VectorState</a> as the state type. Elements derive from <a class="el" href="struct_linear_element_base.html">LinearElementBase</a>.</p>
<p>The vector VectorState::state defaults to all zeros.</p>
<p>The propagation step <a class="el" href="struct_linear_element_base.html#a4165c9f554ca520fa71bc7b9f357e861" title="Propogate the given State through this Element. ">LinearElementBase::advance</a> multiples the an Element's transfer matrix (<a class="el" href="struct_linear_element_base.html#a86278af5e92b5993c28637b0fd4d4a27" title="The transfer matrix. ">LinearElementBase::transfer</a>) with the vector VectorState::state.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} state = Transfer \cdot state \end{eqnarray*}" src="form_1.png"/>
</p>
<h2><a class="anchor" id="simmatrix"></a>
sim_type=TransferMatrix</h2>
<p>Selects use of <a class="el" href="struct_matrix_state.html" title="Simulation state which include only a matrix. ">MatrixState</a> as the state type. Elements derive from <a class="el" href="struct_linear_element_base.html">LinearElementBase</a>.</p>
<p>The matrix MatrixState::state defaults to an identity matrix.</p>
<p>The propagation step <a class="el" href="struct_linear_element_base.html#a4165c9f554ca520fa71bc7b9f357e861" title="Propogate the given State through this Element. ">LinearElementBase::advance</a> multiples the an Element's transfer matrix (<a class="el" href="struct_linear_element_base.html#a86278af5e92b5993c28637b0fd4d4a27" title="The transfer matrix. ">LinearElementBase::transfer</a>) with the matrix MatrixState::state.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} State = Transfer \cdot State \end{eqnarray*}" src="form_2.png"/>
</p>
<h2><a class="anchor" id="simmoment"></a>
sim_type=MomentMatrix</h2>
<p>Selects use of <a class="el" href="struct_moment_state.html">MomentState</a> as the state type. Elements derive from <a class="el" href="struct_moment_element_base.html">MomentElementBase</a></p>
<p><a class="el" href="struct_moment_state.html">MomentState</a> has several components. A single reference <a class="el" href="struct_particle.html">Particle</a> MomentState::ref as well has several members which held as arrays over the number of charge states. MomentState::real hold a <a class="el" href="struct_particle.html">Particle</a> for each charge state. MomentState::moment0 and MomentState::moment1 hold an array of vectors and matricies.</p>
<p>The members MomentState::moment0_env, MomentState::moment1_env, MomentState::moment0_rms are derived from MomentState::moment0 and MomentState::moment1 in MomentState::calc_rms().</p>
<p>A <a class="el" href="struct_particle.html">Particle</a> holds several independent member: <a class="el" href="struct_particle.html#ac8ceb1c792f92c290f34fd40f9e62e25" title="Ion Charge. ">Particle::IonQ</a>, <a class="el" href="struct_particle.html#ae11dcbbbb53633e504947e204ebf40e8" title="Charge state. ">Particle::IonZ</a>, <a class="el" href="struct_particle.html#a5fac73e111d7484d911dbce4822f15c1" title="Rest energy. ">Particle::IonEs</a>, <a class="el" href="struct_particle.html#a19f1b5876e1aa57d2f749df257466172" title="Kinetic energy. ">Particle::IonEk</a>, and <a class="el" href="struct_particle.html#a7610b4cbab1ebca7891ef26b0bcd3d6d" title="Absolute synchrotron phase [rad]. ">Particle::phis</a>. The remaining members are derived from IonEk and IonEs by <a class="el" href="struct_particle.html#a25b34d6ce014b3c6ba63fa141bbc7be4">Particle::recalc()</a>.</p>
<p>Each <a class="el" href="struct_moment_element_base.html" title="An Element which propagates the statistical moments of a bunch. ">MomentElementBase</a> holds an array of transfer matrices (<a class="el" href="struct_moment_element_base.html#aae57f6ccb763ee8012dec14d1e738aa7" title="final transfer matricies ">MomentElementBase::transfer</a>). One for each charge state.</p>
<p>The propagation step <a class="el" href="struct_moment_element_base.html#ac9a50585f66717ad231adfdf6b3d7fea" title="Propogate the given State through this Element. ">MomentElementBase::advance()</a> multiples the an Element's transfer matrix (<a class="el" href="struct_moment_element_base.html#aae57f6ccb763ee8012dec14d1e738aa7" title="final transfer matricies ">MomentElementBase::transfer</a>) with the matrix MomentState::state, and also by the vector MomentState::moment0.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} Moment1_n &amp;=&amp; Transfer_n \cdot Moment1_n \cdot Transfer_n^t \\ moment0_n &amp;=&amp; Transfer_n \cdot moment0_n \end{eqnarray*}" src="form_4.png"/>
</p>
<p>Specializations of advance() exist for the rf cavity and charge stripper elements:</p>
<h3><a class="anchor" id="simmomentcache"></a>
transfer matrix caching</h3>
<p><a class="el" href="struct_moment_element_base.html#aae57f6ccb763ee8012dec14d1e738aa7" title="final transfer matricies ">MomentElementBase::transfer</a> can be viewed as a linear approximation around the given reference and real <a class="el" href="struct_particle.html">Particle</a>. As long as the approximation remains valid, the previously computed (cached) transfer matrix can be reused.</p>
<p>The method <a class="el" href="struct_moment_element_base.html#aab4bc48d548f578ae1e822ab9732a3bc">MomentElementBase::check_cache</a> determines if the cached transfer matrices, and output Particles can be reused. It works by comparing MomentElementBase::last_ref_in and MomentElementBase::last_real_in with MomentState::ref and MomentState::real.</p>
<p>If check_cache() returns true, then ref and real are overwritten with MomentElementBase::last_ref_out and MomentElementBase::last_real_out. If not, then <a class="el" href="struct_moment_element_base.html#ace3232790a9899655ed362494b2f5805" title="recalculate &#39;transfer&#39; taking into consideration the provided input state ">MomentElementBase::recompute_matrix()</a> is called, then ref and real are copied into last_ref_out and last_real_out.</p>
<dl class="section note"><dt>Note</dt><dd>As a debugging/troubleshooting aid, setting the <a class="el" href="class_config.html" title="Associative configuration container. ">Config</a> parameter 'skipcache' to a non-zero value will force check_cache() to return false. This will for recalculation of transfer matricies on each iteration.</dd></dl>
<h3><a class="anchor" id="simmomentconf"></a>
MomentState configuration</h3>
<p>The members of <a class="el" href="struct_moment_state.html">MomentState</a> are configured from a number of input <a class="el" href="class_config.html" title="Associative configuration container. ">Config</a> parameters. Several "magic" parameters control initialization of either 0, 1, or many charge states depending on the presense of the parameters "IonChargeStates" and "cstate".</p>
<p>If neither is included, an empty <a class="el" href="class_config.html" title="Associative configuration container. ">Config</a> will initialize a <a class="el" href="struct_moment_state.html">MomentState</a> with zero charge states. Such a <a class="el" href="struct_moment_state.html">MomentState</a> is only useful in conjunction with the <a class="el" href="typesparams.html#elementsource">source element type </a>.</p>
<p>If only "IonChargeStates" is given, it must be an array of floating point values. This will initalize a number of charge states equal to the length of "IonChargeStates".</p>
<div class="fragment"><div class="line"><span class="preprocessor"># initialize two charge states with a source element in a lattice file</span></div>
<div class="line">S: source, IonChargeStates= [33.0/238.0, 34.0/238.0],</div>
<div class="line">           NCharge        = [10111.0, 10531.0],</div>
<div class="line">           IonEs = 931.49432e6,</div>
<div class="line">           IonEk = 0.5e6,</div>
<div class="line">           vector_variable = <span class="stringliteral">&quot;vecname&quot;</span>,</div>
<div class="line">           matrix_variable = <span class="stringliteral">&quot;matname&quot;</span>,</div>
<div class="line">           vecname0 = [ ... 7 values ... ],</div>
<div class="line">           vecname1 = [ ... 7 values ... ],</div>
<div class="line">           matname0 = [ ... 49 values ... ],</div>
<div class="line">           matname1 = [ ... 49 values ... ];</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># in python</span></div>
<div class="line">M = <a class="code" href="struct_machine.html">Machine</a>(...)</div>
<div class="line">S = M.allocState({</div>
<div class="line">    <span class="stringliteral">&#39;IonChargeStates&#39;</span>:[33.0/238.0, 34.0/238.0],</div>
<div class="line">    <span class="stringliteral">&#39;NCharge&#39;</span>: [10111.0, 10531.0],</div>
<div class="line">    <span class="stringliteral">&#39;IonEs&#39;</span>: 931.49432e6,</div>
<div class="line">    <span class="stringliteral">&#39;IonEk&#39;</span>: 0.5e6,</div>
<div class="line">    <span class="stringliteral">&#39;vector_variable&#39;</span>: <span class="stringliteral">&quot;vecname&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&#39;matrix_variable&#39;</span>: <span class="stringliteral">&quot;matname&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&#39;vecname0&#39;</span>: [ ... 7 values ... ],</div>
<div class="line">    <span class="stringliteral">&#39;vecname1&#39;</span>: [ ... 7 values ... ],</div>
<div class="line">    <span class="stringliteral">&#39;matname0&#39;</span>: [ ... 49 values ... ],</div>
<div class="line">    <span class="stringliteral">&#39;matname1&#39;</span>: [ ... 49 values ... ],</div>
<div class="line">})</div>
</div><!-- fragment --><p>As a debugging/development aid, if the parameter 'cstate' is set to a value in the range [0, # of change states), the the simulation will only be initialized for a single selected change state.</p>
<h2><a class="anchor" id="simelements"></a>
Element Types</h2>
<p>This section lists all element types, and lists which "sim_type"s each is defined for.</p>
<h3><a class="anchor" id="elementsource"></a>
source</h3>
<p>The purpose of the "source" element is to overwrite the State.</p>
<p>Each instance holds an internal State. The advance() method simply assigns this internal State to the state being propagate()d.</p>
<p>The parameters accepted are the same as the associated State type.</p>
<div class="fragment"><div class="line">sim_type = <span class="stringliteral">&quot;Vector&quot;</span>;</div>
<div class="line">elemname: source, initial = [0, 0, 0, 0, 0, 0, 0];</div>
<div class="line"></div>
<div class="line">sim_type = <span class="stringliteral">&quot;TransferMatrix&quot;</span>;</div>
<div class="line">elemname: source, initial = [1, 0, 0, 0, 0, 0, 0,</div>
<div class="line">                             0, 1, 0, 0, 0, 0, 0,</div>
<div class="line">                             0, 0, 1, 0, 0, 0, 0,</div>
<div class="line">                             0, 0, 0, 1, 0, 0, 0,</div>
<div class="line">                             0, 0, 0, 0, 1, 0, 0,</div>
<div class="line">                             0, 0, 0, 0, 0, 1, 0,</div>
<div class="line">                             0, 0, 0, 0, 0, 0, 1];</div>
</div><!-- fragment --><h3><a class="anchor" id="elementdrift"></a>
drift</h3>
<p>A drift section.</p>
<p> 
<table class="param">
<thead><tr><th>Name</th><th>Default</th><th>Desc.</th></tr></thead>
<tbody>
<tr><td>L</td><td>None</td><td>Length</td></tr>
</tbody>
</table>
</p>
<p>Supported by all "sim_type"s.</p>
<div class="fragment"><div class="line">elemname: drift, L = 0.1;</div>
</div><!-- fragment --><h3><a class="anchor" id="elementmarker"></a>
marker</h3>
<p>Equivalent to a zero length drift section. No parameters.</p>
<p>Supported by all "sim_type"s.</p>
<div class="fragment"><div class="line">elemname: marker;</div>
</div><!-- fragment --><h3><a class="anchor" id="elementsbend"></a>
sbend</h3>
<p>Sector bend magnet.</p>
<p> 
<table class="param">
<thead><tr><th>Name</th><th>Default</th><th>Desc.</th></tr></thead>
<tbody>
<tr><td>L</td><td>None</td><td>Length</td></tr>
<tr><td>phi</td><td>None</td><td>Bend angle</td></tr>
<tr><td>phi1</td><td>None</td><td>??? angle</td></tr>
<tr><td>phi2</td><td>None</td><td>??? angle</td></tr>
<tr><td>K</td><td>0.0</td><td>Strength</td></tr>
<tr><td>bg</td><td>None</td><td>Reference energy (beta*gamma)</td></tr>
</tbody>
</table>
</p>
<p>Supported by all "sim_type"s. Only MomentMatrix uses phi1, phi2, and bg.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># general</span></div>
<div class="line">elem1: sbend, L = 0.1, phi = pi/16, K = 10;</div>
<div class="line"><span class="preprocessor"># MomentMatrix</span></div>
<div class="line"><span class="preprocessor">elem2: sbend, L = 0.060000, phi = -1.000000, phi1 = 0.000000, phi2 =  0.000000, bg = 0.190370;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="elementquad"></a>
quadrupole</h3>
<p>Magnetic quadrupole.</p>
<p> 
<table class="param">
<thead><tr><th>Name</th><th>Default</th><th>Desc.</th></tr></thead>
<tbody>
<tr><td>L</td><td>None</td><td>Length</td></tr>
<tr><td>K</td><td>0.0</td><td>Strength.  K&gt;0 focusing in horizontal. K&lt;0 focusing in vertical. </td></tr>
<tr><td>B2</td><td>None</td><td>Field.  B2&gt;0 focusing in horizontal. B2&lt;0 focusing in vertical. </td></tr>
</tbody>
</table>
</p>
<p>Supported by all "sim_type"s. MomentMatrix uses B2, others use K.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># general</span></div>
<div class="line">elem1: quadrupole, L = 0.1, K = 10;</div>
<div class="line"><span class="preprocessor"># MomentMatrix</span></div>
<div class="line"><span class="preprocessor">elem2: quadrupole, L = 0.250000, B2 = 3.459800, aper = 0.025000;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="elementsol"></a>
solenoid</h3>
<p>Solenoid magnet.</p>
<p> 
<table class="param">
<thead><tr><th>Name</th><th>Default</th><th>Desc.</th></tr></thead>
<tbody>
<tr><td>L</td><td>None</td><td>Length</td></tr>
<tr><td>K</td><td>0.0</td><td>Strength.</td></tr>
<tr><td>B</td><td>None</td><td>Field</td></tr>
</tbody>
</table>
</p>
<p>Supported by all "sim_type"s. MomentMatrix uses B, others use K.</p>
<div class="fragment"><div class="line">elemname: solenoid, L = 0.1, K = 10;</div>
</div><!-- fragment --><h3><a class="anchor" id="elementrf"></a>
rfcavity</h3>
<p> 
<table class="param">
<thead><tr><th>Name</th><th>Default</th><th>Desc.</th></tr></thead>
<tbody>
<tr><td>L</td><td>None</td><td>Length</td></tr>
<tr><td>cavtype</td><td>None</td><td>Cavity type ID string</td></tr>
<tr><td>Eng_Data_Dir</td><td>None</td><td>Directory containing data files</td></tr>
<tr><td>f</td><td>None</td><td>Cavity frequency (Hz)</td></tr>
<tr><td>phi</td><td>None</td><td>Synchrotron phase (rad)</td></tr>
<tr><td>scl_fac</td><td>None</td><td>Electric field scale factor</td></tr>
<tr><td>MpoleLevel</td><td>"2"</td><td>"0", "1", or "2"</td></tr>
</tbody>
</table>
</p>
<h3><a class="anchor" id="elementstrip"></a>
stripper</h3>
<p>Placeholder. Equivalent to marker.</p>
<h3><a class="anchor" id="elementedipole"></a>
edipole</h3>
<p>Placeholder. Equivalent to marker.</p>
<h3><a class="anchor" id="elementgeneric"></a>
generic</h3>
<p>Element for which transfer matrix is directly specified.</p>
<p> 
<table class="param">
<thead><tr><th>Name</th><th>Default</th><th>Desc.</th></tr></thead>
<tbody>
<tr><td>transfer</td><td>None</td><td>Flattened transfer matrix</td></tr>
</tbody>
</table>
</p>
<p>Supported by all "sim_type"s.</p>
<div class="fragment"><div class="line">elemname: <span class="keyword">generic</span>, transfer = [1, 0, 0, 0, 0, 0, 0,</div>
<div class="line">                               0, 1, 0, 0, 0, 0, 0,</div>
<div class="line">                               0, 0, 1, 0, 0, 0, 0,</div>
<div class="line">                               0, 0, 0, 1, 0, 0, 0,</div>
<div class="line">                               0, 0, 0, 0, 1, 0, 0,</div>
<div class="line">                               0, 0, 0, 0, 0, 1, 0,</div>
<div class="line">                               0, 0, 0, 0, 0, 0, 1];</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 18 2016 13:55:45 for FLAME by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
